/*!
 * ClockPicker v0.0.7 (http://weareoutman.github.io/clockpicker/)
 * Copyright 2014 Wang Shenwei.
 * Licensed under MIT (https://github.com/weareoutman/clockpicker/blob/gh-pages/LICENSE)
 */
(function(){function s(n){return document.createElementNS(k,n)}function f(n){return(n<10?"0":"")+n}function it(n){var t=++tt+"";return n?n+t:t}function i(i,v){function vt(n,i){var d=st.offset(),g=/^touch/.test(n.type),c=d.left+r,l=d.top+r,f=(g?n.originalEvent.touches[0]:n).pageX-c,s=(g?n.originalEvent.touches[0]:n).pageY-l,nt=Math.sqrt(f*f+s*s),k=!1,tt;if(!i||!(nt<u-e||nt>u+e)){n.preventDefault();tt=setTimeout(function(){a.addClass("clockpicker-moving")},200);h&&st.append(b.canvas);b.setHand(f,s,!i,!0);o.off(y).on(y,function(n){n.preventDefault();var t=/^touch/.test(n.type),i=(t?n.originalEvent.touches[0]:n).pageX-c,r=(t?n.originalEvent.touches[0]:n).pageY-l;(k||i!==f||r!==s)&&(k=!0,b.setHand(i,r,!1,!0))});o.off(p).on(p,function(n){o.off(p);n.preventDefault();var r=/^touch/.test(n.type),u=(r?n.originalEvent.changedTouches[0]:n).pageX-c,e=(r?n.originalEvent.changedTouches[0]:n).pageY-l;(i||k)&&u===f&&e===s&&b.setHand(u,e);b.currentView==="hours"?b.toggleView("minutes",w/2):(v.autoclose&&(b.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){b.done()},w/2)),t(v.afterMinuteSelect));st.prepend(yt);clearTimeout(tt);a.removeClass("clockpicker-moving");o.off(y)})}}var nt=n(rt),st=nt.find(".clockpicker-plate"),pt=nt.find(".clockpicker-hours"),bt=nt.find(".clockpicker-minutes"),ti=nt.find(".clockpicker-am-pm-block"),kt=i.prop("tagName")==="INPUT",dt=kt?i:i.find("input"),gt=i.find(".input-group-addon"),b=this,ni,ii,at,k,d,tt,et,wt,yt,ot,ut,ft,ht,ct,lt;this.id=it("cp");this.element=i;this.options=v;this.isAppended=!1;this.isShown=!1;this.currentView="hours";this.isInput=kt;this.input=dt;this.addon=gt;this.popover=nt;this.plate=st;this.hoursView=pt;this.minutesView=bt;this.amPmBlock=ti;this.spanHours=nt.find(".clockpicker-span-hours");this.spanMinutes=nt.find(".clockpicker-span-minutes");this.spanAmPm=nt.find(".clockpicker-span-am-pm");this.amOrPm="PM";v.twelvehour&&(ni='<div class="clockpicker-am-pm-block"><button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-am-button">AM<\/button><button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-pm-button">PM<\/button><\/div>',ii=n(ni),v.upperCaseAmPm?(b.amStr="AM",b.pmStr="PM"):(b.amStr="am",b.pmStr="pm"),v.leadingSpaceAmPm?(b.amStrFormatted=" "+b.amStr,b.pmStrFormatted=" "+b.pmStr):(b.amStrFormatted=b.amStr,b.pmStrFormatted=b.pmStr),n('<a class="btn btn-sm btn-default clockpicker-button am-button">'+b.amStr+"<\/a>").on("click",function(){b.amOrPm="am";b.popover.find(".clockpicker-span-am-pm").empty().append(b.amStrFormatted);b.popover.find(".pm-button").removeClass("clockpicker-button-on");n(this).addClass("clockpicker-button-on");t(v.afterAmPmSelect)}).appendTo(this.amPmBlock),n('<a class="btn btn-sm btn-default clockpicker-button pm-button">'+b.pmStr+"<\/a>").on("click",function(){b.amOrPm="pm";b.popover.find(".clockpicker-span-am-pm").empty().append(b.pmStrFormatted);b.popover.find(".am-button").removeClass("clockpicker-button-on");n(this).addClass("clockpicker-button-on");t(v.afterAmPmSelect)}).appendTo(this.amPmBlock),n('<a class="btn btn-sm btn-default clockpicker-button switch-hand-button" style="color:#666 !important; background-color:transparent !important; padding:0px; border: 1px solid rgba(0, 0, 0, .2); position:absolute; width:70px; display:block; left:50%; top:0px; margin-left:-35px;">Min <i class="fa fa-arrow-right"><\/i><\/a>').on("click",function(){b.currentView=="minutes"?b.spanHours.click():b.spanMinutes.click()}).appendTo(this.amPmBlock));v.autoclose||n('<a class="btn btn-sm btn-default btn-block clockpicker-button clockpicker-button-done">'+v.donetext+"<\/a>").click(n.proxy(this.done,this)).appendTo(nt);(v.placement==="top"||v.placement==="bottom")&&(v.align==="top"||v.align==="bottom")&&(v.align="left");(v.placement==="left"||v.placement==="right")&&(v.align==="left"||v.align==="right")&&(v.align="top");nt.addClass(v.placement);nt.addClass("clockpicker-align-"+v.align);this.spanHours.click(n.proxy(this.toggleView,this,"hours"));this.spanMinutes.click(n.proxy(this.toggleView,this,"minutes"));dt.on("focus.clockpicker click.clockpicker",n.proxy(this.show,this));gt.on("click.clockpicker",n.proxy(this.toggle,this));if(at=n('<div class="clockpicker-tick"><\/div>'),v.twelvehour)for(k=1;k<13;k+=1){d=at.clone();tt=k/6*Math.PI;et=u;d.css("font-size","120%");d.css({left:r+Math.sin(tt)*et-e,top:r-Math.cos(tt)*et-e});d.html(k===0?"0":k);pt.append(d);d.on(c,vt)}else for(k=0;k<24;k+=1){d=at.clone();tt=k/6*Math.PI;wt=k>0&&k<13;et=wt?l:u;d.css({left:r+Math.sin(tt)*et-e,top:r-Math.cos(tt)*et-e});wt&&d.css("font-size","120%");d.html(k===0?"00":k);pt.append(d);d.on(c,vt)}for(k=0;k<60;k+=5){d=at.clone();tt=k/30*Math.PI;d.css({left:r+Math.sin(tt)*u-e,top:r-Math.cos(tt)*u-e});d.css("font-size","120%");d.html(f(k));bt.append(d);d.on(c,vt)}st.on(c,function(t){n(t.target).closest(".clockpicker-tick").length===0&&vt(t,!0)});h&&(yt=nt.find(".clockpicker-canvas"),ot=s("svg"),ot.setAttribute("class","clockpicker-svg"),ot.setAttribute("width",g),ot.setAttribute("height",g),ut=s("g"),ut.setAttribute("transform","translate("+r+","+r+")"),ft=s("circle"),ft.setAttribute("class","clockpicker-canvas-bearing"),ft.setAttribute("cx",0),ft.setAttribute("cy",0),ft.setAttribute("r",2),ht=s("line"),ht.setAttribute("x1",0),ht.setAttribute("y1",0),ct=s("circle"),ct.setAttribute("class","clockpicker-canvas-bg"),ct.setAttribute("r",e),lt=s("circle"),lt.setAttribute("class","clockpicker-canvas-fg"),lt.setAttribute("r",3.5),ut.appendChild(ht),ut.appendChild(ct),ut.appendChild(lt),ut.appendChild(ft),ot.appendChild(ut),yt.append(ot),this.hand=ht,this.bg=ct,this.fg=lt,this.bearing=ft,this.g=ut,this.canvas=yt);t(this.options.init)}function t(n){n&&typeof n=="function"&&n()}var n=window.jQuery,b=n(window),o=n(document),a,k="http://www.w3.org/2000/svg",h="SVGAngle"in window&&function(){var t,n=document.createElement("div");return n.innerHTML="<svg/>",t=(n.firstChild&&n.firstChild.namespaceURI)==k,n.innerHTML="",t}(),nt=function(){var n=document.createElement("div").style;return"transition"in n||"WebkitTransition"in n||"MozTransition"in n||"msTransition"in n||"OTransition"in n}(),v="ontouchstart"in window,c="mousedown"+(v?" touchstart":""),y="mousemove.clockpicker"+(v?" touchmove.clockpicker":""),p="mouseup.clockpicker"+(v?" touchend.clockpicker":""),d=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,tt=0,r=100,u=80,l=54,e=13,g=r*2,w=nt?350:1,rt='<div class="popover clockpicker-popover"><div class="arrow"><\/div><div class="popover-title"><span class="clockpicker-span-hours text-primary"><\/span> : <span class="clockpicker-span-minutes"><\/span><span class="clockpicker-span-am-pm"><\/span><\/div><div class="popover-content"><div class="clockpicker-plate"><div class="clockpicker-canvas"><\/div><div class="clockpicker-dial clockpicker-hours"><\/div><div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"><\/div><\/div><span class="clockpicker-am-pm-block" style="position:relative;"><\/span><\/div><\/div>';i.DEFAULTS={"default":"",fromnow:0,placement:"bottom",align:"left",donetext:"Done",autoclose:!1,twelvehour:!0,vibrate:!0,leadingZeroHours:!1,upperCaseAmPm:!0,leadingSpaceAmPm:!0};i.prototype.toggle=function(){this[this.isShown?"hide":"show"]()};i.prototype.locate=function(){var r=this.element,i=this.popover,t=r.offset(),u=r.outerWidth(),f=r.outerHeight(),e=this.options.placement,o=this.options.align,n={},s=this;i.show();switch(e){case"bottom":n.top=t.top+f;break;case"right":n.left=t.left+u;break;case"top":n.top=t.top-i.outerHeight();break;case"left":n.left=t.left-i.outerWidth()}switch(o){case"left":n.left=t.left;break;case"right":n.left=t.left+u-i.outerWidth();break;case"top":n.top=t.top;break;case"bottom":n.top=t.top+f-i.outerHeight()}i.css(n)};i.prototype.show=function(){var i,r,e,s,u,h;if(!this.isShown){if(t(this.options.beforeShow),i=this,!this.isAppended){a=n(document.body).append(this.popover);b.on("resize.clockpicker"+this.id,function(){i.isShown&&i.locate()});if(n(".modal").length)n(".modal").on("scroll",function(){i.isShown&&i.locate()});this.isAppended=!0}if(this.input.prop("value")=="")e="",s="am";else if(this.options.twelvehour)if(this.options.leadingSpaceAmPm)r=this.input.prop("value").split(" "),e=r[0],s=r.length>1?r[1].toLowerCase():"am";else var r=this.input.prop("value"),s=r.slice(-2).toLowerCase(),e=r.slice(0,-2);else e=this.input.prop("value"),s="am";u=((e||this.options["default"]||"")+"").split(":");u[0]==="now"&&(h=new Date(+new Date+this.options.fromnow),u=[h.getHours(),h.getMinutes()]);this.hours=+u[0]||0;this.minutes=+u[1]||0;this.amOrPm=s;this.options.leadingZeroHours?this.spanHours.html(f(this.hours)):this.spanHours.html(this.hours);this.spanMinutes.html(f(this.minutes));this.options.twelvehour&&(this.amOrPm=="am"?this.popover.find(".am-button").click():this.popover.find(".pm-button").click());this.toggleView("hours");this.locate();this.isShown=!0;o.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(t){var r=n(t.target);r.closest(i.popover).length===0&&r.closest(i.addon).length===0&&r.closest(i.input).length===0&&i.hide()});o.on("keyup.clockpicker."+this.id,function(n){n.keyCode===27&&i.hide()});t(this.options.afterShow)}};i.prototype.hide=function(){t(this.options.beforeHide);this.isShown=!1;o.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id);o.off("keyup.clockpicker."+this.id);this.popover.hide();t(this.options.afterHide)};i.prototype.toggleView=function(i,r){var f=!1;i==="minutes"&&n(this.hoursView).css("visibility")==="visible"&&(t(this.options.beforeHourSelect),f=!0);var u=i==="hours",o=u?this.hoursView:this.minutesView,e=u?this.minutesView:this.hoursView;this.currentView=i;this.spanHours.toggleClass("text-primary",u);this.spanMinutes.toggleClass("text-primary",!u);e.addClass("clockpicker-dial-out");o.css("visibility","visible").removeClass("clockpicker-dial-out");this.resetClock(r);clearTimeout(this.toggleViewTimer);this.toggleViewTimer=setTimeout(function(){e.css("visibility","hidden")},w);f&&t(this.options.afterHourSelect);this.currentView=="hours"?this.popover.find(".switch-hand-button").html('Min <i class="fa fa-arrow-right"><\/i>'):this.popover.find(".switch-hand-button").html('<i class="fa fa-arrow-left"><\/i> Hour')};i.prototype.resetClock=function(n){var r=this.currentView,t=this[r],f=r==="hours",a=Math.PI/(f?6:30),e=t*a,o=f&&t>0&&t<13?l:u,s=Math.sin(e)*o,c=-Math.cos(e)*o,i=this;h&&n?(i.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){i.canvas.removeClass("clockpicker-canvas-out");i.setHand(s,c)},n)):this.setHand(s,c)};i.prototype.setHand=function(t,i,r,e){var s=Math.atan2(t,-i),c=this.currentView==="hours",p=Math.PI/(c||r?6:30),k=Math.sqrt(t*t+i*i),w=this.options,b=c&&k<(u+l)/2,y=b?l:u,o,a,v;if(w.twelvehour&&(y=u),s<0&&(s=Math.PI*2+s),o=Math.round(s/p),s=o*p,w.twelvehour?c?o===0&&(o=12):(r&&(o*=5),o===60&&(o=0)):c?(o===12&&(o=0),o=b?o===0?12:o:o===0?0:o+12):(r&&(o*=5),o===60&&(o=0)),this[this.currentView]!==o&&d&&this.options.vibrate&&(this.vibrateTimer||(navigator[d](10),this.vibrateTimer=setTimeout(n.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=o,c?this.options.leadingZeroHours?this.spanHours.html(f(o)):this.spanHours.html(o):this.spanMinutes.html(f(o)),!h){this[c?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var t=n(this);t.toggleClass("active",o===+t.html())});return}e||!c&&o%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));a=Math.sin(s)*y;v=-Math.cos(s)*y;this.hand.setAttribute("x2",a);this.hand.setAttribute("y2",v);this.bg.setAttribute("cx",a);this.bg.setAttribute("cy",v);this.fg.setAttribute("cx",a);this.fg.setAttribute("cy",v)};i.prototype.done=function(){t(this.options.beforeDone);this.hide();var i=this.input.prop("value"),n="";n+=this.options.leadingZeroHours?f(this.hours):this.hours;n+=":";n+=f(this.minutes);this.options.twelvehour&&(n=this.amOrPm=="am"?n+this.amStrFormatted:n+this.pmStrFormatted);this.input.prop("value",n);n!==i&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change"));this.options.autoclose&&this.input.trigger("blur");t(this.options.afterDone)};i.prototype.realtimeDone=function(){if(typeof this.hours!="undefined"&&typeof this.minutes!="undefined"){t(this.options.beforeDone);var i=this.input.prop("value"),n="";n+=this.options.leadingZeroHours?f(this.hours):this.hours;n+=":";n+=f(this.minutes);this.options.twelvehour&&(n=this.amOrPm=="am"?n+this.amStrFormatted:n+this.pmStrFormatted);this.input.prop("value",n);n!==i&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change"));this.options.autoclose&&this.input.trigger("blur");t(this.options.afterDone)}};i.prototype.remove=function(){this.element.removeData("clockpicker");this.input.off("focus.clockpicker click.clockpicker");this.addon.off("click.clockpicker");this.isShown&&this.hide();this.isAppended&&(b.off("resize.clockpicker"+this.id),this.popover.remove())};n.fn.clockpicker=function(t){var r=Array.prototype.slice.call(arguments,1);return this.each(function(){var u=n(this),f=u.data("clockpicker"),e;f?typeof f[t]=="function"&&f[t].apply(f,r):(e=n.extend({},i.DEFAULTS,u.data(),typeof t=="object"&&t),u.data("clockpicker",new i(u,e)))})}})();